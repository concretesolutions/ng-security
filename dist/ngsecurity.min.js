/*
 ngsecurity v1.6.0
 (c) 2015 Concrete Solutions, Inc.
 License: MIT
*/
//# sourceMappingURL=ngsecurity.min.js.map
'use strict';(function(){function m(d,e,b){return{multiElement:!0,transclude:"element",priority:600,terminal:!0,restrict:"A",$$tlb:!0,link:function(c,a,f,h,k){var g=new n(c,a,f,h,k,e);c.deregister=b.$on("authChanged",function(a,e){g.handle(e)});c.$on("$destroy",function(){c.deregister()});g.handle(d.isAuthenticated())}}}function p(d,e,b){return{multiElement:!0,transclude:"element",priority:600,terminal:!0,restrict:"A",$$tlb:!0,link:function(c,a,f,h,k){var g=new n(c,a,f,h,k,e);c.deregister=b.$on("authChanged",
function(a,e){g.handle(!e)});c.$on("$destroy",function(){c.deregister()});g.handle(!d.isAuthenticated())}}}function q(d){return{link:function(e,b,c){var a=b.css("display"),f=c.ngPermissionType,h=c.ngIfPermission.split(",");e.$watch(function(){return d.getPermissions()},function(){d.getPermissionValidation(f)(h)?b.css("display",a):b.css("display","none")},!0)},restrict:"A"}}function r(d,e){return{link:function(b,c,a){var f=c.css("display"),h=a.ngPermissionType,k=function(a){d.hasPermission(a)||d.getPermissionValidation(h)(a)?
c.css("display",f):c.css("display","none")};b.$watch(function(){return e(a.ngIfPermissionModel)(b)},function(a){k(a)});b.$watch(function(){return d.getPermissions()},function(){var d=e(a.ngIfPermissionModel)(b);k(d)},!0)},restrict:"A"}}function t(d){return{link:function(e,b,c){var a=c.ngPermissionType,f=c.ngEnabledPermission.split(",");e.$watch(function(){return d.getPermissions()},function(){d.getPermissionValidation(a)(f)?b.removeAttr("disabled"):b.attr("disabled","true")},!0)},restrict:"A"}}function u(d){return{link:function(e,
b,c){b.bind("click",d.logout)},restrict:"A"}}function v(d){return{link:function(e,b,c){e.$watch(function(){return d.getUser()},function(a){b.text(a[c.ngBindUser])},!0)},restrict:"A"}}function w(d,e){return{link:function(b,c,a,f){c.bind("submit",function(){var f=a.ngSubmitLogin,k=c.find("input"),g={};angular.forEach(k,function(a){"submit"!==a.type&&a.name&&(g[a.name]=a.value)});e.loginByUrl(f,g).then(function(a){d.$broadcast("ng-security:login:success");b.ngLoginSuccess({$response:a})}).catch(function(a){d.$broadcast("ng-security:login:error");
b.ngLoginError({$response:a})})})},restrict:"A",scope:{ngLoginSuccess:"&",ngLoginError:"&"},require:"^form"}}function x(d){return{link:function(e,b,c,a){var f=b.css("display");b.css("display","none");d.$on("ng-security:login:success",function(){b.css("display",f)});d.$on("ng-security:login:error",function(){b.css("display","none")})},restrict:"AEC"}}function y(d){return{link:function(e,b,c,a){var f=b.css("display");b.css("display","none");d.$on("ng-security:login:success",function(){b.css("display",
"none")});d.$on("ng-security:login:error",function(){b.css("display",f)})},restrict:"AEC"}}function n(d,e,b,c,a,f){function h(a){for(var e=a[0],d=a[a.length-1],b,c=1;e!==d&&(e=e.nextSibling);c++)if(b||a[c]!==e)b||(b=jqLite(slice.call(a,0,c))),b.push(e);return b||a}var k,g,l;this.handle=function(b){b?g||a(function(a,b){g=b;a[a.length++]=document.createComment(" end ng-securityIf");k={clone:a};f.enter(a,e.parent(),e)}):(l&&(l.remove(),l=null),g&&(g.$destroy(),g=null),k&&(l=h(k.clone),f.leave(l).then(function(){l=
null}),k=null))}}function z(d,e,b,c,a){var f={login:function(){h[a.strategy].apply(this,arguments);return d.$emit("authChanged",f.isAuthenticated())},loginByUrl:function(a,e){return b(function(b,h){c.post(a,e).success(function(a){f.login(a.token,a.user,a.permissions);d.$emit("authChanged",f.isAuthenticated());b(a)}).error(h)})},logout:function(){e.remove(a.storageName.token);e.remove(a.storageName.user);e.remove(a.storageName.permissions);d.$emit("authChanged",f.isAuthenticated())},hasPermission:function(b){var d=
e.getObject(a.storageName.permissions);return d?-1!==d.indexOf(b):!1},hasAllPermission:function(b){var d=e.getObject(a.storageName.permissions),c=!0;b&&d?angular.forEach(b,function(a){-1===d.indexOf(a)&&(c=!1)}):c=!1;return c},hasAnyPermission:function(b){var d=e.getObject(a.storageName.permissions),c=!1;b&&d&&angular.forEach(b,function(a){-1!==d.indexOf(a)&&(c=!0)});return c},getPermissionValidation:function(a){var b={ANY:f.hasAnyPermission,ALL:f.hasAllPermission};a||(a="ANY");return b[a]},isAuthenticated:function(){return!!e.get(a.storageName.token)},
getUser:function(){return e.getObject(a.storageName.user)},getPermissions:function(){return e.getObject(a.storageName.permissions)}},h={jwt:function(b,d){var c;c=b.split(".")[1];if(2===c.length%4)c+="==";else if(3===c.length%4)c+="=";else if(0!==c.length%4)throw"Invalid token string.";c=JSON.parse(atob(c));e.put(a.storageName.token,a.token.prefix+b);e.putObject(a.storageName.user,c);e.putObject(a.storageName.permissions,d)},simple:function(b,c,d){e.put(a.storageName.token,a.token.prefix+b);e.putObject(a.storageName.user,
c);e.putObject(a.storageName.permissions,d)}};return f}function A(d,e,b,c){return{request:function(a){a.headers[c.token.header]=b.get(c.storageName.token);return a},responseError:function(a){var b=c.responseErrorName;b[a.status]&&d.$broadcast(b[a.status],a);return e.reject(a)}}}angular.module("ngSecurity",["ngCookies"]);angular.module("ngSecurity").directive("ngIfAuthenticated",m).directive("ngIfAnonymous",p).directive("ngIfPermission",q).directive("ngIfPermissionModel",r).directive("ngEnabledPermission",
t).directive("ngClickLogout",u).directive("ngBindUser",v).directive("ngSubmitLogin",w).directive("ngShowLoginSuccess",x).directive("ngShowLoginError",y);m.$inject=["$security","$animate","$rootScope"];p.$inject=["$security","$animate","$rootScope"];q.$inject=["$security"];r.$inject=["$security","$parse"];t.$inject=["$security"];u.$inject=["$security"];v.$inject=["$security"];w.$inject=["$rootScope","$security"];x.$inject=["$rootScope"];y.$inject=["$rootScope"];angular.module("ngSecurity").provider("$securityConfig",
function(){var d={},e={strategy:"simple",token:{header:"Authorization",prefix:""},storageName:{token:"ng-security-authorization",user:"ng-security-user",permissions:"ng-security-permissions"},responseErrorName:{401:"unauthenticated",403:"permissionDenied"}};d.$get=function(){return e};d.configure=function(b){e=angular.merge(e,b)};return d});angular.module("ngSecurity").factory("$security",z).factory("$securityInterceptor",A);z.$inject=["$rootScope","$cookies","$q","$http","$securityConfig"];A.$inject=
["$rootScope","$q","$cookies","$securityConfig"]}).call(window);
